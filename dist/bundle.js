var t={d:(e,s)=>{for(var i in s)t.o(s,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:s[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{J:()=>a,A:()=>n});class s{data;compare;constructor(t){this.data=[],this.compare=t||function(t,e){return t-e}}push(t){const e=this.data.length;this.data[e]=t,this.shiftUp(e)}peek(){return this.data[0]}pop(){if(this.data.length<=1)return this.data.shift();const t=this.data[0],e=this.data.pop();return void 0!==e&&t!==e?(this.data[0]=e,this.shiftDown(0),t):t}shiftUp(t){for(;t>0;){const e=t>>>1,s=this.data[e],o=this.data[t];if(!(this.compare(s,o)>0))return;i(this.data,t,e),t=e}}shiftDown(t){const e=this.data.length,s=(e>>>1)-1;for(;t<=s;){const s=2*(t+1)-1,o=s+1,a=this.data[t],r=this.data[s],n=this.data[o];if(this.compare(a,r)>0)o<e&&this.compare(r,n)>0?(i(this.data,t,o),t=o):(i(this.data,t,s),t=s);else{if(!(o<e&&this.compare(a,n)>0))return;i(this.data,t,o),t=o}}}show(){const t=this.data;return t&&0!==t.length?function e(s,i,o){if(s>=t.length||null===t[s]||void 0===t[s])return"";const a=t[s],r=2*s+1;let n="";return n+=e(2*s+2,i+1,o+6),n+=" ".repeat(o)+a+"\n",n+=e(r,i+1,o+6),n}(0,0,0):""}toString=this.show;toJSON=this.show;valueOf=this.show}function i(t,e,s){const i=t[e];t[e]=t[s],t[s]=i}const o=(t,e)=>{const s=t.expirationTime-e.expirationTime;return 0!==s?s:t.id-e.id};var a;!function(t){t.IMMEDIATE_PRIORITY="IMMEDIATE_PRIORITY",t.USER_BLOCKING_PRIORITY="USER_BLOCKING_PRIORITY",t.NORMAL_PRIORITY="NORMAL_PRIORITY",t.LOW_PRIORITY="LOW_PRIORITY",t.IDLE_PRIORITY="IDLE_PRIORITY"}(a||(a={}));const r={[a.IMMEDIATE_PRIORITY]:-1,[a.USER_BLOCKING_PRIORITY]:250,[a.NORMAL_PRIORITY]:500,[a.LOW_PRIORITY]:1e3,[a.IDLE_PRIORITY]:Number.MAX_SAFE_INTEGER},n=new class{taskQueue=new s(o);timerQueue=new s(o);userTaskCnt=0;isMessageLoopRunning=!1;isHostCallbackScheduled=!1;isPerformingWork=!1;isHostTimeoutScheduled=!1;timerId=void 0;startTime=-1;scheduleCallback(t=a.NORMAL_PRIORITY,e=()=>{},s=0){const i=performance.now(),o=i+s,n=o+(r[t]||r[a.NORMAL_PRIORITY]),h={id:this.userTaskCnt++,priorityLevel:t,startTime:o,expirationTime:n,callback:e,sortIndex:-1};return o>i?(h.sortIndex=o,this.timerQueue.push(h),this.timerQueue.peek()===h&&(this.cancelHostTimeout(),this.requestHostTimeout(this.handleTimeout,h.startTime-performance.now()))):(h.sortIndex=n,this.taskQueue.push(h),this.isHostCallbackScheduled||this.isPerformingWork||(this.isHostCallbackScheduled=!0,this.requestHostCallback())),h}cancelCallback(t){t.callback=null}requestHostCallback(){this.isMessageLoopRunning||(this.isMessageLoopRunning=!0,this.schedulePerformWorkUntilDeadline())}advacneTimers(){}handleTimeout(){if(this.isHostTimeoutScheduled=!1,this.advacneTimers(),!this.isHostTimeoutScheduled)if(this.taskQueue.peek())this.isHostTimeoutScheduled=!0,this.requestHostCallback();else{const t=this.timerQueue.peek();t&&this.requestHostTimeout(this.handleTimeout,t.startTime-performance.now())}}requestHostTimeout(t,e){this.isHostTimeoutScheduled||(this.isHostTimeoutScheduled=!0,this.timerId=setTimeout(t,e))}cancelHostTimeout(){this.isHostTimeoutScheduled&&(clearTimeout(this.timerId),this.timerId=void 0,this.isHostTimeoutScheduled=!1)}performWorkUntilDeadline(){if(this.isMessageLoopRunning){const t=performance.now();this.startTime=t;let e=!0;try{e=this.flushWork(t)}finally{e?this.schedulePerformWorkUntilDeadline():this.isMessageLoopRunning=!1}}}schedulePerformWorkUntilDeadline(){if("function"==typeof MessageChannel){const t=new MessageChannel;t.port2.onmessage=this.performWorkUntilDeadline.bind(this),t.port1.postMessage(null)}else setTimeout((()=>{this.performWorkUntilDeadline()}))}flushWork(t){this.isHostCallbackScheduled=!1,this.cancelHostTimeout(),this.isPerformingWork=!0;try{return this.workLoop(t)}finally{this.isPerformingWork=!1}}workLoop(t){let e=t;this.advacneTimers();let s=this.taskQueue.peek(),i=!1;for(;s&&(i=s.expirationTime<e,i||!this.shouldYieldToHost());){const t=s.callback;if(s.callback=null,"function"==typeof t){const e=t(i);if("function"==typeof e)return s.callback=e,this.advacneTimers(),!0;s===this.taskQueue.peek()&&this.taskQueue.pop(),this.advacneTimers()}else this.taskQueue.pop();s=this.taskQueue.peek()}if(s)return!0;if(this.timerQueue.peek()){const t=this.timerQueue.peek();t&&this.requestHostTimeout(this.handleTimeout,t.startTime-performance.now())}return!1}shouldYieldToHost(){return!(performance.now()-this.startTime<5)}};var h=e.J,u=e.A;export{h as PriorityLevel,u as default};